<!doctype html>
<html lang="en"></html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="Content-Security-Policy" content="default-src 'self' gap:; script-src 'self' 'unsafe-eval'; object-src *; style-src 'self' data: 'unsafe-inline'; img-src 'self' data:; media-src 'self' data:; font-src 'self' https://fonts.gstatic.com/ data:; connect-src *;">

		<script src="js/jquery-3.7.1.min.js" defer></script>
		
		<link rel="stylesheet" href="css/bootstrap-icons.min.css">
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/overlayscrollbars.min.css">
		<link rel="stylesheet" href="css/masked.css">
		<link rel="stylesheet" href="css/window.css">

		<script src="js/bootstrap.bundle.min.js"></script>		
		<script src="js/overlayscrollbars.browser.es6.min.js" defer></script>
	</head>

	<body class="inconsolata shadow border border-black " data-bs-theme="light" style="width: 750px; height: 445px; overflow: hidden;">
		<div class="bg-primary bg-gradient text-white border border-black">
			<div class="d-flex justify-content-center align-content-center p-1">
				<div>
					<img id="masked-logo" name="masked-logo" src="../icons/icons8-mask2-32.png" />
				</div>
				
				<div class="ms-2">
					<h4 class="pt-1">Masked</h4>
				</div>
			</div>
		</div>

		<div class="row mb-3">
			<div class="col-4 me-1">
				<div id="list-tab" class="list-group"  style="border-top-left-radius: 0%;" role="tablist">
					<a class="list-group-item list-group-item-action active" id="list-home-list" data-bs-toggle="list" href="#list-home" role="tab" aria-controls="list-home">
						<i class="bi bi-house me-2"></i> Home
					</a>
					<a class="list-group-item list-group-item-action" id="list-secrets-list" data-bs-toggle="list" href="#list-secrets" role="tab" aria-controls="list-secrets">
						<i class="bi bi-file-lock2 me-2"></i> Secrets
					</a>
					<a class="list-group-item list-group-item-action" id="list-regex-list" data-bs-toggle="list" href="#list-regex" role="tab" aria-controls="list-regex">
						<i class="bi bi-braces-asterisk me-2"></i> Regex
					</a>

					<a class="list-group-item list-group-item-action" id="list-elements-list" data-bs-toggle="list" href="#list-elements" role="tab" aria-controls="list-elements">
						<i class="bi bi-bar-chart-steps me-2"></i> Elements
					</a>

					<a class="list-group-item list-group-item-action" id="list-settings-list" data-bs-toggle="list" href="#list-settings" role="tab" aria-controls="list-settings">
						<i class="bi bi-sliders me-2"></i> Settings
					</a>

					<a class="list-group-item list-group-item-action" id="list-suggestions-list" data-bs-toggle="list" href="#list-suggestions" role="tab" aria-controls="list-suggestions">
						<i class="bi bi-chat-heart"></i> Suggestions
					</a>

					<a class="list-group-item list-group-item-action" id="list-credits-list" data-bs-toggle="list" href="#list-credits" role="tab" aria-controls="list-credits">
						<i class="bi bi-blockquote-left me-2"></i> Credits
					</a>

					<div id="status" class="text-center">
						<pre></pre>
					</div>
				</div>
			</div>

			<div id="masked-container" class="col-6 border ps-3 pt-3 me-2" style="min-height: 395px; max-height: 395px; width: 506.5px; margin-left: -12px;" >
				<div class="tab-content" id="nav-tabContent">
					<div class="tab-pane fade show active" id="list-home" role="tabpanel" aria-labelledby="list-home-list">
						A simple plugin to convert sensitive information on the screen to a <span class="text-primary">Masked</span> format.
						The <span class="text-primary">Masked</span> value can then easily be copied to your clipboard via small icon, which
						is added into the element which was masked.	Customize your mask, add your own regular expressions and keywords and
						no longer worry about shoulder-surfers, or people watching your streams.
					</div>

					<div class="tab-pane fade overflow-hidden" id="list-secrets" role="tabpanel" aria-labelledby="list-secrets-list" style="min-height: 400px; max-height: 400px;" data-overlayscrollbars-initialize>
						<div class="row me-4 mt-3">
							<div class="col">
								<div class="input-group">
									<span class="input-group-text">Secrets</span>
									<select id="secrets-list" name="secrets-list" class="form-select" size="10" aria-label="Secrets" multiple ></select>
								</div>

								<div class="input-group">
									<span class="input-group-text">Add&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
									<input id="add-secret" name="add-secret" type="text" class="form-control" />
								</div>
							</div>
						</div>
						
						<div class="row mt-3">
							<div class="col text-center">
								<div class="btn-group btn-group-sm" role="group" aria-label="Secrets Group">
									<button id="secret-append" name="secret-append" class="btn btn-success" type="button">Append</button>
									<button id="secret-clear"  name="secret-clear"  class="btn btn-warning" type="button" data-bs-toggle="modal" data-bs-target="#modal-clear">Clear</button>
									<button id="secret-remove" name="secret-remove" class="btn btn-danger"  type="button">Remove</button>
								</div>
							</div>
						</div>
					</div>
			  
					<div id="list-regex" class="tab-pane fade overflow-hidden" role="tabpanel" aria-labelledby="list-regex-list" style="min-height: 400px; max-height: 400px;">
						<div class="row mb-3 me-4 mt-3">
							<div class="col">
								<div class="input-group">
									<span class="input-group-text">Regex</span>
									<select id="regex-list" name="regex-list" class="form-select" size="10" aria-label="Regex" multiple></select>
								</div>
								
								<div class="input-group">
									<span class="input-group-text text-bg-secondary">Add</span>
									<span class="input-group-text text-bg-secondary">/</span>
									<input id="add-regex" name="add-regex" type="text" class="form-control" />
									<span class="input-group-text text-bg-secondary">/g</span>
								</div>
							</div>
						</div>
						
						<div class="row">
							<div class="col text-center">
								<div class="btn-group btn-group-sm" role="group" aria-label="Secrets Group">
									<button id="regex-append" name="regex-append" class="btn btn-success" type="button">Append</button>
									<button id="regex-clear"  name="regex-clear"  class="btn btn-warning" type="button" data-bs-toggle="modal" data-bs-target="#modal-clear">Clear</button>
									<button id="regex-remove" name="regex-remove" class="btn btn-danger"  type="button">Remove</button>
								</div>
							</div>
						</div>
					</div>

					<div class="tab-pane fade" id="list-elements" role="tabpanel" aria-labelledby="list-elements-list" style="min-height: 400px; max-height: 400px;">
						<div class="row mb-3">
							<div class="col me-3">
								<select id="secret-element-list" name="secret-element-list" class="form-select" size="10" aria-label="Regex" multiple></select>
								<div class="input-group">
									<span class="input-group-text text-bg-secondary"><i class="bi bi-arrow-right-circle"></i></span>
									<input id="add-secret-element" name="add-secret-element" type="text" class="form-control" />
								</div>
							</div>

							<div class="col">
								<select id="regex-element-list" name="regex-element-list" class="form-select" size="10" aria-label="Regex Element" multiple></select>
								<div class="input-group">
									<span class="input-group-text text-bg-secondary"><i class="bi bi-arrow-right-circle"></i></span>
									<input id="add-regex-element" name="add-regex-element" type="text" class="form-control" />
								</div>
							</div>
						</div>

						<div class="row">
							<div class="col text-center">
								<div class="btn-group btn-group-sm" role="group" aria-label="Secrets Group">
									<button id="ele-append" name="ele-append" class="btn btn-success" type="button">Append</button>
									<button id="ele-clear"  name="ele-clear"  class="btn btn-warning" type="button" data-bs-toggle="modal" data-bs-target="#modal-clear">Clear</button>
									<button id="ele-remove" name="ele-remove" class="btn btn-danger"  type="button">Remove</button>
								</div>
							</div>
						</div>
					</div>
			
					<div class="tab-pane fade overflow-hidden" id="list-settings" role="tabpanel" aria-labelledby="list-settings-list" style="min-height: 400px; max-height: 400px; width: 503px;" >
						<div id="settings-pane" name="settings-pane" class="container">
							<div class="row">
								<p class="lead">Settings</p>
							</div>

							<div class="row mb-3 me-4 mt-3">
								<div class="col">
									<div class="form-check form-switch">
										<input id="option-secrets-in-regex" name="option-secrets-in-regex" class="form-check-input" type="checkbox" role="switch">
										<label class="form-check-label" for="option-secrets-in-regex">Include Secrets in Regex Search</label>
									</div>

									<small style="font-size: 10px;">
										Any secrets which are to be searched for in ID's, will also be added to the regex list
									</small>
								</div>
							</div>

							<div class="row mb-3 me-4 mt-3">
								<div class="col">
									<div class="form-check form-switch">
										<input id="option-regex-in-secrets" name="option-regex-in-secrets" class="form-check-input" type="checkbox" role="switch">
										<label class="form-check-label" for="option-regex-in-secrets">Include Regex in Secrets Search</label>
									</div>

									<small style="font-size: 10px;">
										Any regex which are to be searched for in ID's, will also be added to the secrets list
									</small>
								</div>
							</div>

							<div class="row">
								<div class="col mt-3">
									<div class="form-check form-switch">
										<input id="option-mask-emails" name="option-mask-emails" class="form-check-input" type="checkbox" role="switch">
										<label class="form-check-label" for="option-mask-emails">Mask emails</label>
									</div>

									<small style="font-size: 10px;">
										Fields which are detected as email fields will be masked as well
									</small>
								</div>
							</div>

							<div class="row">
								<div class="col mt-3">
									<div class="form-check form-switch">
										<input id="option-enable-regex" name="option-enable-regex" class="form-check-input" type="checkbox" role="switch">
										<label class="form-check-label" for="option-enable-regex">Enable Regex Searching</label>
									</div>

									<small style="font-size: 10px;">
										Enables the regex functionality which allows you to search more elements, with more matching capabilities
									</small>
								</div>
							</div>

							<div class="row">
								<div class="col mt-3">
									<div class="form-check form-switch">
										<input id="option-enable-window" name="option-enable-window" class="form-check-input" type="checkbox" role="switch">
										<label class="form-check-label" for="option-enable-window">Results Window</label>
									</div>

									<small style="font-size: 10px;">
										Enables/disables a small hidable window which will contain all the matches from both secret and regex's
									</small>
								</div>
							</div>

							<div class="row">
								<div class="col mt-3">
									<div class="form-check form-switch">
										<input class="form-check-input" type="checkbox" role="switch" id="option-enable-darkmode" name="option-enable-darkmode">
										<label class="form-check-label" for="option-enable-darkmode">Dark Mode</label>
									</div>

									<small style="font-size: 10px;">
										Toggles between dark and light themes
									</small>
								</div>
							</div>

							<div class="row">
								<div class="col mt-3">
									<div class="form-check form-switch">
										<input class="form-check-input" type="checkbox" role="switch" id="option-enable-secret" name="option-enable-secret">
										<label class="form-check-label" for="option-mask-emails">Enable ID Searching</label>
									</div>

									<small style="font-size: 10px;">
										Enables the ID searching functionality which searches HTML elements matching input fields
									</small>
								</div>
							</div>

							<div class="row">
								<div class="col mt-3" style="max-height: 420px;">
									<div class="form-check form-switch">
										<input class="form-check-input" type="checkbox" role="switch" id="option-enable-secret" name="option-enable-secret">
										<label class="form-check-label" for="option-mask-emails">Enable ID Searching</label>
									</div>

									<small style="font-size: 10px;">
										Enables the ID searching functionality which searches HTML elements matching input fields
									</small>
								</div>
							</div>
							
							<div class="row">
								<div class="col mt-3">
									<div class="form-check form-switch">
										<input class="form-check-input" type="checkbox" role="switch" id="option-enable-secret" name="option-enable-secret">
										<label class="form-check-label" for="option-mask-emails">Enable ID Searching</label>
									</div>

									<small style="font-size: 10px;">
										Enables the ID searching functionality which searches HTML elements matching input fields
									</small>
								</div>
							</div>
						</div>
					</div>

					<div class="tab-pane fade" id="list-credits" role="tabpanel" aria-labelledby="list-credits-list" style="min-height: 400px; max-height: 400px;">
						<div class="row">
							<div class="col mt-3">
								<div class="text-center">
									Most of the regular expressions and ID compositions have been collected compiled from SecLists & gitleaks<br>
									Some of the ID's are collected from websites I use<br>
									<small><a href="https://raw.githubusercontent.com/gitleaks/gitleaks/master/config/gitleaks.toml">GitLeaks .toml (Regex)</a></small><br>
									<small><a href="https://github.com/SecLists">SecLists (ID's)</a></small>
								</div>
							</div>
						</div>
					</div>

					<div class="tab-pane fade" id="list-suggestions" role="tabpanel" aria-labelledby="list-suggestions-list" style="min-height: 400px; max-height: 400px;">
						<div class="row">
							<div class="col mt-3">
								<div class="input-group mb-3">
									<button id="suggestion-dropdown" class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
										Type&nbsp;&nbsp;
									</button>
									<ul class="dropdown-menu">
										<li><a id="suggestion-type-regex"  class="dropdown-item" href="#">Regex&nbsp;&nbsp;</a></li>
								  		<li><a id="suggestion-type-secret" class="dropdown-item" href="#">Secret&nbsp;&nbsp;</a></li>
								  		<li><a id="suggestion-type-other"  class="dropdown-item" href="#">Other&nbsp;&nbsp;</a></li>
									</ul>
									<input type="text" class="form-control" aria-label="wat">
							  	</div>
							</div>

							<div id="suggestion-example-url" class="input-group mb-3" style="display: none;">
								<span class="input-group-text" id="example-url">Example</span>
								<input type="text" class="form-control" placeholder="https://example.com/?page_id=372" aria-label="Example" aria-describedby="example-url">
								<small class="input-group ms-1" style="font-size: 10px;">A URL where the suggestion can be seen (for regex/secret validation)</small>
							</div>
							
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="modal fade" id="modal-clear" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false" role="dialog" aria-labelledby="modal-clear-title" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
				<div class="modal-content">
					<div class="modal-header text-bg-danger bg-gradient">
						<h5 class="modal-title" id="modal-clear-title">Danger!</h5>
						<button	type="button" class="btn-close"	data-bs-dismiss="modal"	aria-label="Close"></button>
					</div>
					<div class="modal-body">
						Are you sure you want to clear this list? This cannot be undone!
					</div>
					<div class="modal-footer">
						<button	id="modal-clear" type="button" class="btn btn-danger ps-4 pe-4" data-bs-dismiss="modal">Yes</button>
						<button type="button" class="btn btn-secondary ps-4 pe-4" data-bs-dismiss="modal">No</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Window adapted from https://codepen.io/marcusparsons/pen/NMyzgR -->
		<div id="results-window" class="window">
			<div class="window-top">
				<i class="bi bi-brightness-alt-low-fill"></i><button class="round red"></button>
			</div>
			<div class="window-content">

			</div>
		</div>

		<script src="../handlers.js"></script>
		<script src="../functions.js"></script>
		<script src="js/popup.js"></script>	
	</body>
</html>